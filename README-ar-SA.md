# WindowsAutoConfig ⚙️

[🇺🇸 English](README.md) | [🇫🇷 Français](README-fr-FR.md) | [🇩🇪 Deutsch](README-de-DE.md) | [🇪🇸 Español](README-es-ES.md) | [🇮🇳 हिंदी](README-hi-IN.md) | [🇯🇵 日本語](README-ja-JP.md) | [🇷🇺 Русский](README-ru-RU.md) | [🇨🇳 中文](README-zh-CN.md) | [🇧🇩 বাংলা](README-bn-BD.md) | [🇮🇩 Bahasa Indonesia](README-id-ID.md)

**الطيار الآلي الخاص بك لمحطات عمل Windows المخصصة. قم بالتهيئة مرة واحدة، ودع النظام يدير نفسه بشكل موثوق.**

![الترخيص](https://img.shields.io/badge/Licence-GPLv3-blue.svg)![إصدار PowerShell](https://img.shields.io/badge/PowerShell-5.1%2B-blue)![الحالة](https://img.shields.io/badge/Status-Operational-brightgreen.svg)![نظام التشغيل](https://img.shields.io/badge/OS-Windows_10_|_11-informational)![الدعم](https://img.shields.io/badge/Support-11_Languages-orange.svg)![المساهمات](https://img.shields.io/badge/Contributions-Welcome-brightgreen.svg)

---

## 🎯 مهمتنا

تخيل محطة عمل Windows موثوقة ومستقلة تمامًا. جهاز تقوم بتهيئته مرة واحدة لمهمته وتنساه بعد ذلك. نظام يضمن أن تطبيقك يظل **قيد التشغيل بشكل دائم**، دون انقطاع.

هذا هو الهدف الذي يساعدك **WindowsAutoConfig** على تحقيقه. التحدي هو أن جهاز كمبيوتر يعمل بنظام Windows القياسي غير مصمم أصلاً لهذا التحمل. إنه مصمم للتفاعل البشري: يذهب إلى وضع السكون، ويثبت التحديثات عندما يراها مناسبة، ولا يعيد تشغيل التطبيق تلقائيًا بعد إعادة التشغيل.

**WindowsAutoConfig** هو الحل: مجموعة من البرامج النصية التي تعمل كمشرف ذكي ودائم. يحول أي جهاز كمبيوتر إلى آلة موثوقة، مما يضمن أن تطبيقك الحرج يعمل دائمًا، دون تدخل يدوي.

### لماذا تم إنشاء `WindowsAutoConfig`؟ قصة حاجة حقيقية.

`WindowsAutoConfig` هو حل هندسي، ولد من الحاجة إلى ضمان **الاستمرارية التشغيلية** على نظام تشغيل سطح المكتب. **تم تطويره كجزء من حل الذكاء الاصطناعي المحلي الخاص بنا AllSys، وهو الآن أداة مفتوحة المصدر قائمة بذاتها يمكن استخدامها لأي تطبيق.**

لقد واجهنا ليس نوعًا واحدًا، بل نوعين من الإخفاقات النظامية:

#### 1. الفشل المفاجئ: الانقطاع غير المتوقع

السيناريو بسيط: جهاز مهيأ للوصول عن بعد وانقطاع التيار الكهربائي ليلاً. حتى مع وجود BIOS مهيأ لإعادة التشغيل التلقائي، تفشل المهمة. يعيد Windows التشغيل ولكنه يظل على شاشة تسجيل الدخول؛ لا يتم إعادة تشغيل التطبيق الحرج، ولا يتم فتح الجلسة. النظام لا يمكن الوصول إليه.

#### 2. التدهور البطيء: عدم الاستقرار على المدى الطويل

الأكثر غدرًا هو سلوك Windows بمرور الوقت. نظرًا لأنه مصمم كنظام تشغيل تفاعلي، فهو غير مُحسَّن للعمليات التي تعمل دون انقطاع. تظهر تسربات الذاكرة وتدهور الأداء تدريجيًا، مما يجعل النظام غير مستقر ويتطلب إعادة تشغيل يدوية.

### الجواب: طبقة موثوقية أصلية

في مواجهة هذه التحديات، أثبتت الأدوات المساعدة لجهات خارجية عدم كفايتها. لذلك اتخذنا قرارًا **بتصميم طبقة مرونة النظام الخاصة بنا.**

يعمل `WindowsAutoConfig` كطيار آلي يتحكم في نظام التشغيل من أجل:

- **ضمان الاسترداد التلقائي:** بعد الفشل، يضمن فتح الجلسة وإعادة تشغيل تطبيقك الرئيسي.
- **ضمان الصيانة الوقائية:** يسمح لك بجدولة إعادة تشغيل يومية خاضعة للرقابة مع تنفيذ برامج نصية مخصصة مسبقًا.
- **حماية التطبيق** من الانقطاعات غير المرغوب فيها من Windows (التحديثات، وضع السكون ...).

`WindowsAutoConfig` هي الأداة الأساسية لأي شخص يحتاج إلى أن تظل محطة عمل Windows **موثوقة ومستقرة وتعمل دون مراقبة مستمرة.**

---

## 💡 حالات الاستخدام النموذجية

*   **اللافتات الرقمية:** ضمان تشغيل برنامج اللافتات على مدار الساعة طوال أيام الأسبوع على شاشة عامة.
*   **الخوادم المنزلية وإنترنت الأشياء:** التحكم في خادم Plex أو بوابة Home Assistant أو كائن متصل من جهاز كمبيوتر يعمل بنظام Windows.
*   **محطات الإشراف:** الحفاظ على تطبيق المراقبة (الكاميرات، سجلات الشبكة) نشطًا دائمًا.
*   **الأكشاك التفاعلية:** التأكد من إعادة تشغيل تطبيق الكشك تلقائيًا بعد كل إعادة تشغيل.
*   **الأتمتة خفيفة الوزن:** تشغيل البرامج النصية أو العمليات بشكل مستمر لمهام استخراج البيانات أو الاختبار.

---

## ✨ الميزات الرئيسية

*   **معالج التكوين الرسومي:** لا حاجة لتعديل الملفات للإعدادات الأساسية.
*   **دعم متعدد اللغات بالكامل:** الواجهة والسجلات متوفرة بـ 11 لغة، مع الكشف التلقائي عن لغة النظام.
*   **إدارة الطاقة:** تعطيل وضع سكون الجهاز، ووضع سكون الشاشة، وبدء التشغيل السريع لـ Windows لتحقيق أقصى قدر من الاستقرار.
*   **تسجيل الدخول التلقائي (Auto-Login):** يدير تسجيل الدخول التلقائي، بما في ذلك بالتآزر مع أداة **Sysinternals AutoLogon** لإدارة كلمات المرور بشكل آمن.
*   **التحكم في تحديثات Windows:** منع التحديثات وإعادة التشغيل القسرية من تعطيل تطبيقك.
*   **مدير العمليات:** يقوم تلقائيًا بتشغيل ومراقبة وإعادة تشغيل تطبيقك الرئيسي مع كل جلسة.
*   **إعادة تشغيل يومية مجدولة:** جدولة إعادة تشغيل يومية للحفاظ على حيوية النظام.
*   **إجراء ما قبل إعادة التشغيل:** تنفيذ برنامج نصي مخصص (نسخ احتياطي، تنظيف ...) قبل إعادة التشغيل المجدولة.
*   **تسجيل مفصل:** يتم تسجيل جميع الإجراءات في ملفات السجل لتشخيص سهل.
*   **الإشعارات (اختياري):** إرسال تقارير الحالة عبر Gotify.

---

## 🎯 الجمهور المستهدف وأفضل الممارسات

تم تصميم هذا المشروع لتحويل جهاز كمبيوتر إلى آلة موثوقة، وهو مثالي لحالات الاستخدام حيث يكون الجهاز مخصصًا لتطبيق واحد (خادم لجهاز إنترنت الأشياء، لافتات رقمية، محطة مراقبة، إلخ). لا ينصح به لجهاز كمبيوتر مكتبي للأغراض العامة أو للاستخدام اليومي.

*   **تحديثات Windows الرئيسية:** بالنسبة للتحديثات الهامة (على سبيل المثال، الترقية من Windows 10 إلى 11)، فإن الإجراء الأكثر أمانًا هو **إلغاء تثبيت** WindowsAutoConfig قبل التحديث، ثم **إعادة تثبيته** بعد ذلك.
*   **بيئات الشركات:** إذا كان جهاز الكمبيوتر الخاص بك في مجال شركة تتم إدارته بواسطة كائنات نهج المجموعة (GPOs)، فتحقق مع قسم تكنولوجيا المعلومات لديك للتأكد من أن التعديلات التي أجراها هذا البرنامج النصي لا تتعارض مع سياسات مؤسستك.

---

## 🚀 التثبيت والبدء

**ملاحظة حول اللغة:** تعرض البرامج النصية للإطلاق (`1_install.bat` و `2_uninstall.bat`) تعليماتها باللغة **الإنجليزية**. هذا أمر طبيعي. تعمل هذه الملفات كمشغلات بسيطة. بمجرد أن يتولى المعالج الرسومي أو البرامج النصية لـ PowerShell المسؤولية، ستتكيف الواجهة تلقائيًا مع لغة نظام التشغيل لديك.

إعداد **WindowsAutoConfig** عملية بسيطة وموجهة.

1.  **قم بتنزيل** أو استنساخ المشروع على الكمبيوتر المراد تكوينه.
2.  قم بتشغيل `1_install.bat`. سيرشدك البرنامج النصي خلال خطوتين:
    *   **الخطوة 1: التكوين عبر المعالج الرسومي.**
        اضبط الخيارات وفقًا لاحتياجاتك. أهمها عادةً اسم المستخدم لتسجيل الدخول التلقائي والتطبيق المراد تشغيله. انقر فوق `حفظ` للحفظ.
    *   **الخطوة 2: تثبيت مهام النظام.**
        سيطلب منك البرنامج النصي تأكيد المتابعة. ستفتح نافذة أمان Windows (UAC). **يجب عليك قبولها** للسماح للبرنامج النصي بإنشاء المهام المجدولة اللازمة.
3.  هذا كل شيء! عند إعادة التشغيل التالية، سيتم تطبيق تكويناتك.

---

## 🔧 التكوين
يمكنك ضبط الإعدادات في أي وقت بطريقتين:

### 1. المعالج الرسومي (الطريقة البسيطة)
أعد تشغيل `1_install.bat` لإعادة فتح واجهة التكوين. قم بتعديل إعداداتك واحفظها.

### 2. ملف `config.ini` (الطريقة المتقدمة)
افتح `config.ini` باستخدام محرر نصوص للتحكم الدقيق.

#### ملاحظة هامة حول تسجيل الدخول التلقائي وكلمات المرور
لأسباب أمنية، **لا يقوم WindowsAutoConfig أبدًا بإدارة أو تخزين كلمات المرور بنص عادي.** إليك كيفية تكوين تسجيل الدخول التلقائي بفعالية وأمان:

*   **السيناريو 1: حساب المستخدم ليس له كلمة مرور.**
    ما عليك سوى إدخال اسم المستخدم في المعالج الرسومي أو في `AutoLoginUsername` في ملف `config.ini`.

*   **السيناريو 2: حساب المستخدم له كلمة مرور (الطريقة الموصى بها).**
    1.  قم بتنزيل أداة **[Sysinternals AutoLogon](https://download.sysinternals.com/files/AutoLogon.zip)** الرسمية من Microsoft (رابط تنزيل مباشر).
    2.  قم بتشغيل AutoLogon وأدخل اسم المستخدم والمجال وكلمة المرور. ستقوم هذه الأداة بتخزين كلمة المرور بشكل آمن في السجل.
    3.  في تكوين **WindowsAutoConfig**، يمكنك الآن ترك حقل `AutoLoginUsername` فارغًا (سيكتشف البرنامج النصي المستخدم الذي تم تكوينه بواسطة AutoLogon عن طريق قراءة مفتاح السجل المقابل) أو تعبئته للتأكد. سيضمن برنامجنا النصي تمكين مفتاح السجل `AutoAdminLogon` بشكل صحيح لإنهاء التكوين.

#### التكوين المتقدم: `PreRebootActionCommand`
تتيح لك هذه الميزة القوية تنفيذ برنامج نصي قبل إعادة التشغيل اليومية. يمكن أن يكون المسار:
- **مطلقًا:** `C:\Scripts\my_backup.bat`
- **نسبيًا للمشروع:** `PreReboot.bat` (سيبحث البرنامج النصي عن هذا الملف في جذر المشروع).
- **باستخدام `%USERPROFILE%`:** `%USERPROFILE%\Desktop\cleanup.ps1` (سيقوم البرنامج النصي بذكاء باستبدال `%USERPROFILE%` بالمسار إلى ملف تعريف مستخدم تسجيل الدخول التلقائي).

---

## 📂 هيكل المشروع
```
WindowsAutoConfig/
├── 1_install.bat                # نقطة الدخول للتثبيت والتكوين
├── 2_uninstall.bat              # نقطة الدخول لإلغاء التثبيت
├── config.ini                   # ملف التكوين المركزي
├── config_systeme.ps1           # البرنامج النصي الرئيسي لإعدادات الجهاز (يعمل عند بدء التشغيل)
├── config_utilisateur.ps1       # البرنامج النصي الرئيسي لإدارة عمليات المستخدم (يعمل عند تسجيل الدخول)
├── LaunchApp.bat                # (مثال) مشغل محمول لتطبيقك الرئيسي
├── PreReboot.bat                # مثال على برنامج نصي لإجراء ما قبل إعادة التشغيل
├── Logs/                        # (يتم إنشاؤه تلقائيًا) يحتوي على ملفات السجل
├── i18n/                        # يحتوي على جميع ملفات الترجمة
│   ├── ar-SA/strings.psd1
│   └── ... (لغات أخرى)
└── management/
    ├── defaults/default_config.ini # قالب التكوين الأولي
    ├── tools/                   # أدوات التشخيص
    │   └── Find-WindowInfo.ps1
    ├── firstconfig.ps1          # رمز معالج التكوين الرسومي
    ├── install.ps1              # البرنامج النصي الفني لتثبيت المهام
    └── uninstall.ps1            # البرنامج النصي الفني لحذف المهام
```

---

## ⚙️ التشغيل المفصل
يعتمد جوهر **WindowsAutoConfig** على مجدول مهام Windows:

1.  **عند بدء تشغيل Windows**
    *   تعمل مهمة `WindowsAutoConfig_SystemStartup` بامتيازات `SYSTEM`.
    *   يقرأ البرنامج النصي `config_systeme.ps1` ملف `config.ini` ويطبق جميع تكوينات الجهاز. كما أنه يدير إنشاء / تحديث مهام إعادة التشغيل.

2.  **عند تسجيل دخول المستخدم**
    *   تعمل مهمة `WindowsAutoConfig_UserLogon`.
    *   يقرأ البرنامج النصي `config_utilisateur.ps1` قسم `[Process]` من `config.ini` ويضمن تشغيل تطبيقك الرئيسي بشكل صحيح. إذا كان يعمل بالفعل، يتم إيقافه أولاً ثم إعادة تشغيله بشكل نظيف.

3.  **يوميًا (إذا تم تكوينه)**
    *   تنفذ مهمة `WindowsAutoConfig_PreRebootAction` برنامج النسخ الاحتياطي / التنظيف الخاص بك.
    *   بعد بضع دقائق، تقوم مهمة `WindowsAutoConfig_ScheduledReboot` بإعادة تشغيل الكمبيوتر.

---

### 🛠️ أدوات التشخيص والتطوير
يتضمن المشروع برامج نصية مفيدة لمساعدتك في تكوين المشروع وصيانته.

*   **`management/tools/Find-WindowInfo.ps1`**: إذا كنت لا تعرف العنوان الدقيق لنافذة التطبيق (على سبيل المثال، لتكوينها في `Close-AppByTitle.ps1`)، فقم بتشغيل هذا البرنامج النصي. سيقوم بسرد جميع النوافذ المرئية وأسماء عملياتها، مما يساعدك في العثور على المعلومات الدقيقة.
*   **`Fix-Encoding.ps1`**: إذا قمت بتعديل البرامج النصية، تضمن هذه الأداة حفظها بالترميز الصحيح (UTF-8 with BOM) للتوافق التام مع PowerShell 5.1 والأحرف الدولية.

---

## 📄 التسجيل
لتسهيل استكشاف الأخطاء وإصلاحها، يتم تسجيل كل شيء.
*   **الموقع:** في المجلد الفرعي `Logs/`.
*   **الملفات:** `config_systeme_ps_log.txt` و `config_utilisateur_log.txt`.
*   **التناوب:** يتم أرشفة السجلات القديمة تلقائيًا لمنعها من أن تصبح كبيرة جدًا.

---

## 🗑️ إلغاء التثبيت
لإزالة النظام:
1.  قم بتشغيل `2_uninstall.bat`.
2.  **اقبل طلب الامتيازات (UAC)**.
3.  سيقوم البرنامج النصي بإزالة جميع المهام المجدولة بشكل نظيف واستعادة إعدادات النظام الرئيسية.

**ملاحظة حول قابلية العكس:** لا يقتصر إلغاء التثبيت على إزالة المهام المجدولة فقط. بل إنه يعيد أيضًا إعدادات النظام الرئيسية إلى حالتها الافتراضية لمنحك نظامًا نظيفًا:
*   يتم إعادة تمكين تحديثات Windows.
*   يتم إعادة تمكين بدء التشغيل السريع.
*   تتم إزالة السياسة التي تمنع OneDrive.
*   سيعرض البرنامج النصي تعطيل تسجيل الدخول التلقائي.

وبالتالي يعود نظامك إلى كونه محطة عمل قياسية، مع عدم وجود تعديلات متبقية.

---

## ❤️ الترخيص والمساهمات
يتم توزيع هذا المشروع بموجب ترخيص **GPLv3**. النص الكامل متاح في ملف `LICENSE`.

نرحب بالمساهمات، سواء في شكل تقارير أخطاء أو اقتراحات تحسين أو طلبات سحب.